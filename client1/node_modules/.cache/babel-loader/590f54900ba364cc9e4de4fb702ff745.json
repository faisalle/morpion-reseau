{"ast":null,"code":"'use strict';\n\nvar RingBuffer = require('./ring_buffer');\n\nvar Pledge = function () {\n  this._complete = false;\n  this._callbacks = new RingBuffer(Pledge.QUEUE_SIZE);\n};\n\nPledge.QUEUE_SIZE = 4;\n\nPledge.all = function (list) {\n  var pledge = new Pledge(),\n      pending = list.length,\n      n = pending;\n  if (pending === 0) pledge.done();\n\n  while (n--) list[n].then(function () {\n    pending -= 1;\n    if (pending === 0) pledge.done();\n  });\n\n  return pledge;\n};\n\nPledge.prototype.then = function (callback) {\n  if (this._complete) callback();else this._callbacks.push(callback);\n};\n\nPledge.prototype.done = function () {\n  this._complete = true;\n  var callbacks = this._callbacks,\n      callback;\n\n  while (callback = callbacks.shift()) callback();\n};\n\nmodule.exports = Pledge;","map":{"version":3,"names":["RingBuffer","require","Pledge","_complete","_callbacks","QUEUE_SIZE","all","list","pledge","pending","length","n","done","then","prototype","callback","push","callbacks","shift","module","exports"],"sources":["/home/faisal/ServerExample/client/client/node_modules/websocket-extensions/lib/pipeline/pledge.js"],"sourcesContent":["'use strict';\n\nvar RingBuffer = require('./ring_buffer');\n\nvar Pledge = function() {\n  this._complete  = false;\n  this._callbacks = new RingBuffer(Pledge.QUEUE_SIZE);\n};\n\nPledge.QUEUE_SIZE = 4;\n\nPledge.all = function(list) {\n  var pledge  = new Pledge(),\n      pending = list.length,\n      n       = pending;\n\n  if (pending === 0) pledge.done();\n\n  while (n--) list[n].then(function() {\n    pending -= 1;\n    if (pending === 0) pledge.done();\n  });\n  return pledge;\n};\n\nPledge.prototype.then = function(callback) {\n  if (this._complete) callback();\n  else this._callbacks.push(callback);\n};\n\nPledge.prototype.done = function() {\n  this._complete = true;\n  var callbacks = this._callbacks, callback;\n  while (callback = callbacks.shift()) callback();\n};\n\nmodule.exports = Pledge;\n"],"mappings":"AAAA;;AAEA,IAAIA,UAAU,GAAGC,OAAO,CAAC,eAAD,CAAxB;;AAEA,IAAIC,MAAM,GAAG,YAAW;EACtB,KAAKC,SAAL,GAAkB,KAAlB;EACA,KAAKC,UAAL,GAAkB,IAAIJ,UAAJ,CAAeE,MAAM,CAACG,UAAtB,CAAlB;AACD,CAHD;;AAKAH,MAAM,CAACG,UAAP,GAAoB,CAApB;;AAEAH,MAAM,CAACI,GAAP,GAAa,UAASC,IAAT,EAAe;EAC1B,IAAIC,MAAM,GAAI,IAAIN,MAAJ,EAAd;EAAA,IACIO,OAAO,GAAGF,IAAI,CAACG,MADnB;EAAA,IAEIC,CAAC,GAASF,OAFd;EAIA,IAAIA,OAAO,KAAK,CAAhB,EAAmBD,MAAM,CAACI,IAAP;;EAEnB,OAAOD,CAAC,EAAR,EAAYJ,IAAI,CAACI,CAAD,CAAJ,CAAQE,IAAR,CAAa,YAAW;IAClCJ,OAAO,IAAI,CAAX;IACA,IAAIA,OAAO,KAAK,CAAhB,EAAmBD,MAAM,CAACI,IAAP;EACpB,CAHW;;EAIZ,OAAOJ,MAAP;AACD,CAZD;;AAcAN,MAAM,CAACY,SAAP,CAAiBD,IAAjB,GAAwB,UAASE,QAAT,EAAmB;EACzC,IAAI,KAAKZ,SAAT,EAAoBY,QAAQ,GAA5B,KACK,KAAKX,UAAL,CAAgBY,IAAhB,CAAqBD,QAArB;AACN,CAHD;;AAKAb,MAAM,CAACY,SAAP,CAAiBF,IAAjB,GAAwB,YAAW;EACjC,KAAKT,SAAL,GAAiB,IAAjB;EACA,IAAIc,SAAS,GAAG,KAAKb,UAArB;EAAA,IAAiCW,QAAjC;;EACA,OAAOA,QAAQ,GAAGE,SAAS,CAACC,KAAV,EAAlB,EAAqCH,QAAQ;AAC9C,CAJD;;AAMAI,MAAM,CAACC,OAAP,GAAiBlB,MAAjB"},"metadata":{},"sourceType":"script"}