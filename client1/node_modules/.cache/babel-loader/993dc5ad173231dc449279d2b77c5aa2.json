{"ast":null,"code":"'use strict';\n\nvar Buffer = require('safe-buffer').Buffer,\n    Base = require('./base'),\n    Draft75 = require('./draft75'),\n    crypto = require('crypto'),\n    util = require('util');\n\nvar numberFromKey = function (key) {\n  return parseInt((key.match(/[0-9]/g) || []).join(''), 10);\n};\n\nvar spacesInKey = function (key) {\n  return (key.match(/ /g) || []).length;\n};\n\nvar Draft76 = function (request, url, options) {\n  Draft75.apply(this, arguments);\n  this._stage = -1;\n  this._body = [];\n  this.version = 'hixie-76';\n\n  this._headers.clear();\n\n  this._headers.set('Upgrade', 'WebSocket');\n\n  this._headers.set('Connection', 'Upgrade');\n\n  this._headers.set('Sec-WebSocket-Origin', this._request.headers.origin);\n\n  this._headers.set('Sec-WebSocket-Location', this.url);\n};\n\nutil.inherits(Draft76, Draft75);\nvar instance = {\n  BODY_SIZE: 8,\n  start: function () {\n    if (!Draft75.prototype.start.call(this)) return false;\n    this._started = true;\n\n    this._sendHandshakeBody();\n\n    return true;\n  },\n  close: function () {\n    if (this.readyState === 3) return false;\n    if (this.readyState === 1) this._write(Buffer.from([0xFF, 0x00]));\n    this.readyState = 3;\n    this.emit('close', new Base.CloseEvent(null, null));\n    return true;\n  },\n  _handshakeResponse: function () {\n    var headers = this._request.headers,\n        key1 = headers['sec-websocket-key1'],\n        key2 = headers['sec-websocket-key2'];\n    if (!key1) throw new Error('Missing required header: Sec-WebSocket-Key1');\n    if (!key2) throw new Error('Missing required header: Sec-WebSocket-Key2');\n    var number1 = numberFromKey(key1),\n        spaces1 = spacesInKey(key1),\n        number2 = numberFromKey(key2),\n        spaces2 = spacesInKey(key2);\n    if (number1 % spaces1 !== 0 || number2 % spaces2 !== 0) throw new Error('Client sent invalid Sec-WebSocket-Key headers');\n    this._keyValues = [number1 / spaces1, number2 / spaces2];\n    var start = 'HTTP/1.1 101 WebSocket Protocol Handshake',\n        headers = [start, this._headers.toString(), ''];\n    return Buffer.from(headers.join('\\r\\n'), 'binary');\n  },\n  _handshakeSignature: function () {\n    if (this._body.length < this.BODY_SIZE) return null;\n    var md5 = crypto.createHash('md5'),\n        buffer = Buffer.allocUnsafe(8 + this.BODY_SIZE);\n    buffer.writeUInt32BE(this._keyValues[0], 0);\n    buffer.writeUInt32BE(this._keyValues[1], 4);\n    Buffer.from(this._body).copy(buffer, 8, 0, this.BODY_SIZE);\n    md5.update(buffer);\n    return Buffer.from(md5.digest('binary'), 'binary');\n  },\n  _sendHandshakeBody: function () {\n    if (!this._started) return;\n\n    var signature = this._handshakeSignature();\n\n    if (!signature) return;\n\n    this._write(signature);\n\n    this._stage = 0;\n\n    this._open();\n\n    if (this._body.length > this.BODY_SIZE) this.parse(this._body.slice(this.BODY_SIZE));\n  },\n  _parseLeadingByte: function (octet) {\n    if (octet !== 0xFF) return Draft75.prototype._parseLeadingByte.call(this, octet);\n    this._closing = true;\n    this._length = 0;\n    this._stage = 1;\n  }\n};\n\nfor (var key in instance) Draft76.prototype[key] = instance[key];\n\nmodule.exports = Draft76;","map":{"version":3,"names":["Buffer","require","Base","Draft75","crypto","util","numberFromKey","key","parseInt","match","join","spacesInKey","length","Draft76","request","url","options","apply","arguments","_stage","_body","version","_headers","clear","set","_request","headers","origin","inherits","instance","BODY_SIZE","start","prototype","call","_started","_sendHandshakeBody","close","readyState","_write","from","emit","CloseEvent","_handshakeResponse","key1","key2","Error","number1","spaces1","number2","spaces2","_keyValues","toString","_handshakeSignature","md5","createHash","buffer","allocUnsafe","writeUInt32BE","copy","update","digest","signature","_open","parse","slice","_parseLeadingByte","octet","_closing","_length","module","exports"],"sources":["/home/faisal/ServerExample/client/client/node_modules/websocket-driver/lib/websocket/driver/draft76.js"],"sourcesContent":["'use strict';\n\nvar Buffer  = require('safe-buffer').Buffer,\n    Base    = require('./base'),\n    Draft75 = require('./draft75'),\n    crypto  = require('crypto'),\n    util    = require('util');\n\n\nvar numberFromKey = function(key) {\n  return parseInt((key.match(/[0-9]/g) || []).join(''), 10);\n};\n\nvar spacesInKey = function(key) {\n  return (key.match(/ /g) || []).length;\n};\n\n\nvar Draft76 = function(request, url, options) {\n  Draft75.apply(this, arguments);\n  this._stage  = -1;\n  this._body   = [];\n  this.version = 'hixie-76';\n\n  this._headers.clear();\n\n  this._headers.set('Upgrade', 'WebSocket');\n  this._headers.set('Connection', 'Upgrade');\n  this._headers.set('Sec-WebSocket-Origin', this._request.headers.origin);\n  this._headers.set('Sec-WebSocket-Location', this.url);\n};\nutil.inherits(Draft76, Draft75);\n\nvar instance = {\n  BODY_SIZE: 8,\n\n  start: function() {\n    if (!Draft75.prototype.start.call(this)) return false;\n    this._started = true;\n    this._sendHandshakeBody();\n    return true;\n  },\n\n  close: function() {\n    if (this.readyState === 3) return false;\n    if (this.readyState === 1) this._write(Buffer.from([0xFF, 0x00]));\n    this.readyState = 3;\n    this.emit('close', new Base.CloseEvent(null, null));\n    return true;\n  },\n\n  _handshakeResponse: function() {\n    var headers = this._request.headers,\n        key1    = headers['sec-websocket-key1'],\n        key2    = headers['sec-websocket-key2'];\n\n    if (!key1) throw new Error('Missing required header: Sec-WebSocket-Key1');\n    if (!key2) throw new Error('Missing required header: Sec-WebSocket-Key2');\n\n    var number1 = numberFromKey(key1),\n        spaces1 = spacesInKey(key1),\n\n        number2 = numberFromKey(key2),\n        spaces2 = spacesInKey(key2);\n\n    if (number1 % spaces1 !== 0 || number2 % spaces2 !== 0)\n      throw new Error('Client sent invalid Sec-WebSocket-Key headers');\n\n    this._keyValues = [number1 / spaces1, number2 / spaces2];\n\n    var start   = 'HTTP/1.1 101 WebSocket Protocol Handshake',\n        headers = [start, this._headers.toString(), ''];\n\n    return Buffer.from(headers.join('\\r\\n'), 'binary');\n  },\n\n  _handshakeSignature: function() {\n    if (this._body.length < this.BODY_SIZE) return null;\n\n    var md5    = crypto.createHash('md5'),\n        buffer = Buffer.allocUnsafe(8 + this.BODY_SIZE);\n\n    buffer.writeUInt32BE(this._keyValues[0], 0);\n    buffer.writeUInt32BE(this._keyValues[1], 4);\n    Buffer.from(this._body).copy(buffer, 8, 0, this.BODY_SIZE);\n\n    md5.update(buffer);\n    return Buffer.from(md5.digest('binary'), 'binary');\n  },\n\n  _sendHandshakeBody: function() {\n    if (!this._started) return;\n    var signature = this._handshakeSignature();\n    if (!signature) return;\n\n    this._write(signature);\n    this._stage = 0;\n    this._open();\n\n    if (this._body.length > this.BODY_SIZE)\n      this.parse(this._body.slice(this.BODY_SIZE));\n  },\n\n  _parseLeadingByte: function(octet) {\n    if (octet !== 0xFF)\n      return Draft75.prototype._parseLeadingByte.call(this, octet);\n\n    this._closing = true;\n    this._length  = 0;\n    this._stage   = 1;\n  }\n};\n\nfor (var key in instance)\n  Draft76.prototype[key] = instance[key];\n\nmodule.exports = Draft76;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}