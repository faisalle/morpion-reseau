{"ast":null,"code":"'use strict';\n\nvar Buffer = require('safe-buffer').Buffer;\n\nvar StreamReader = function () {\n  this._queue = [];\n  this._queueSize = 0;\n  this._offset = 0;\n};\n\nStreamReader.prototype.put = function (buffer) {\n  if (!buffer || buffer.length === 0) return;\n  if (!Buffer.isBuffer(buffer)) buffer = Buffer.from(buffer);\n\n  this._queue.push(buffer);\n\n  this._queueSize += buffer.length;\n};\n\nStreamReader.prototype.read = function (length) {\n  if (length > this._queueSize) return null;\n  if (length === 0) return Buffer.alloc(0);\n  this._queueSize -= length;\n  var queue = this._queue,\n      remain = length,\n      first = queue[0],\n      buffers,\n      buffer;\n\n  if (first.length >= length) {\n    if (first.length === length) {\n      return queue.shift();\n    } else {\n      buffer = first.slice(0, length);\n      queue[0] = first.slice(length);\n      return buffer;\n    }\n  }\n\n  for (var i = 0, n = queue.length; i < n; i++) {\n    if (remain < queue[i].length) break;\n    remain -= queue[i].length;\n  }\n\n  buffers = queue.splice(0, i);\n\n  if (remain > 0 && queue.length > 0) {\n    buffers.push(queue[0].slice(0, remain));\n    queue[0] = queue[0].slice(remain);\n  }\n\n  return Buffer.concat(buffers, length);\n};\n\nStreamReader.prototype.eachByte = function (callback, context) {\n  var buffer, n, index;\n\n  while (this._queue.length > 0) {\n    buffer = this._queue[0];\n    n = buffer.length;\n\n    while (this._offset < n) {\n      index = this._offset;\n      this._offset += 1;\n      callback.call(context, buffer[index]);\n    }\n\n    this._offset = 0;\n\n    this._queue.shift();\n  }\n};\n\nmodule.exports = StreamReader;","map":{"version":3,"names":["Buffer","require","StreamReader","_queue","_queueSize","_offset","prototype","put","buffer","length","isBuffer","from","push","read","alloc","queue","remain","first","buffers","shift","slice","i","n","splice","concat","eachByte","callback","context","index","call","module","exports"],"sources":["/home/faisal/ServerExample/client/client/node_modules/websocket-driver/lib/websocket/driver/stream_reader.js"],"sourcesContent":["'use strict';\n\nvar Buffer = require('safe-buffer').Buffer;\n\nvar StreamReader = function() {\n  this._queue     = [];\n  this._queueSize = 0;\n  this._offset    = 0;\n};\n\nStreamReader.prototype.put = function(buffer) {\n  if (!buffer || buffer.length === 0) return;\n  if (!Buffer.isBuffer(buffer)) buffer = Buffer.from(buffer);\n  this._queue.push(buffer);\n  this._queueSize += buffer.length;\n};\n\nStreamReader.prototype.read = function(length) {\n  if (length > this._queueSize) return null;\n  if (length === 0) return Buffer.alloc(0);\n\n  this._queueSize -= length;\n\n  var queue  = this._queue,\n      remain = length,\n      first  = queue[0],\n      buffers, buffer;\n\n  if (first.length >= length) {\n    if (first.length === length) {\n      return queue.shift();\n    } else {\n      buffer = first.slice(0, length);\n      queue[0] = first.slice(length);\n      return buffer;\n    }\n  }\n\n  for (var i = 0, n = queue.length; i < n; i++) {\n    if (remain < queue[i].length) break;\n    remain -= queue[i].length;\n  }\n  buffers = queue.splice(0, i);\n\n  if (remain > 0 && queue.length > 0) {\n    buffers.push(queue[0].slice(0, remain));\n    queue[0] = queue[0].slice(remain);\n  }\n  return Buffer.concat(buffers, length);\n};\n\nStreamReader.prototype.eachByte = function(callback, context) {\n  var buffer, n, index;\n\n  while (this._queue.length > 0) {\n    buffer = this._queue[0];\n    n = buffer.length;\n\n    while (this._offset < n) {\n      index = this._offset;\n      this._offset += 1;\n      callback.call(context, buffer[index]);\n    }\n    this._offset = 0;\n    this._queue.shift();\n  }\n};\n\nmodule.exports = StreamReader;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}