{"ast":null,"code":"'use strict';\n\nvar util = require('util'),\n    net = require('net'),\n    tls = require('tls'),\n    url = require('url'),\n    driver = require('websocket-driver'),\n    API = require('./api'),\n    Event = require('./api/event');\n\nvar DEFAULT_PORTS = {\n  'http:': 80,\n  'https:': 443,\n  'ws:': 80,\n  'wss:': 443\n},\n    SECURE_PROTOCOLS = ['https:', 'wss:'];\n\nvar Client = function (_url, protocols, options) {\n  options = options || {};\n  this.url = _url;\n  this._driver = driver.client(this.url, {\n    maxLength: options.maxLength,\n    protocols: protocols\n  });\n  ['open', 'error'].forEach(function (event) {\n    this._driver.on(event, function () {\n      self.headers = self._driver.headers;\n      self.statusCode = self._driver.statusCode;\n    });\n  }, this);\n\n  var proxy = options.proxy || {},\n      endpoint = url.parse(proxy.origin || this.url),\n      port = endpoint.port || DEFAULT_PORTS[endpoint.protocol],\n      secure = SECURE_PROTOCOLS.indexOf(endpoint.protocol) >= 0,\n      onConnect = function () {\n    self._onConnect();\n  },\n      netOptions = options.net || {},\n      originTLS = options.tls || {},\n      socketTLS = proxy.origin ? proxy.tls || {} : originTLS,\n      self = this;\n\n  netOptions.host = socketTLS.host = endpoint.hostname;\n  netOptions.port = socketTLS.port = port;\n  originTLS.ca = originTLS.ca || options.ca;\n  socketTLS.servername = socketTLS.servername || endpoint.hostname;\n  this._stream = secure ? tls.connect(socketTLS, onConnect) : net.connect(netOptions, onConnect);\n  if (proxy.origin) this._configureProxy(proxy, originTLS);\n  API.call(this, options);\n};\n\nutil.inherits(Client, API);\n\nClient.prototype._onConnect = function () {\n  var worker = this._proxy || this._driver;\n  worker.start();\n};\n\nClient.prototype._configureProxy = function (proxy, originTLS) {\n  var uri = url.parse(this.url),\n      secure = SECURE_PROTOCOLS.indexOf(uri.protocol) >= 0,\n      self = this,\n      name;\n  this._proxy = this._driver.proxy(proxy.origin);\n\n  if (proxy.headers) {\n    for (name in proxy.headers) this._proxy.setHeader(name, proxy.headers[name]);\n  }\n\n  this._proxy.pipe(this._stream, {\n    end: false\n  });\n\n  this._stream.pipe(this._proxy);\n\n  this._proxy.on('connect', function () {\n    if (secure) {\n      var options = {\n        socket: self._stream,\n        servername: uri.hostname\n      };\n\n      for (name in originTLS) options[name] = originTLS[name];\n\n      self._stream = tls.connect(options);\n\n      self._configureStream();\n    }\n\n    self._driver.io.pipe(self._stream);\n\n    self._stream.pipe(self._driver.io);\n\n    self._driver.start();\n  });\n\n  this._proxy.on('error', function (error) {\n    self._driver.emit('error', error);\n  });\n};\n\nmodule.exports = Client;","map":{"version":3,"names":["util","require","net","tls","url","driver","API","Event","DEFAULT_PORTS","SECURE_PROTOCOLS","Client","_url","protocols","options","_driver","client","maxLength","forEach","event","on","self","headers","statusCode","proxy","endpoint","parse","origin","port","protocol","secure","indexOf","onConnect","_onConnect","netOptions","originTLS","socketTLS","host","hostname","ca","servername","_stream","connect","_configureProxy","call","inherits","prototype","worker","_proxy","start","uri","name","setHeader","pipe","end","socket","_configureStream","io","error","emit","module","exports"],"sources":["/home/faisal/ServerExample/client/client/node_modules/faye-websocket/lib/faye/websocket/client.js"],"sourcesContent":["'use strict';\n\nvar util   = require('util'),\n    net    = require('net'),\n    tls    = require('tls'),\n    url    = require('url'),\n    driver = require('websocket-driver'),\n    API    = require('./api'),\n    Event  = require('./api/event');\n\nvar DEFAULT_PORTS    = { 'http:': 80, 'https:': 443, 'ws:':80, 'wss:': 443 },\n    SECURE_PROTOCOLS = ['https:', 'wss:'];\n\nvar Client = function(_url, protocols, options) {\n  options = options || {};\n\n  this.url     = _url;\n  this._driver = driver.client(this.url, { maxLength: options.maxLength, protocols: protocols });\n\n  ['open', 'error'].forEach(function(event) {\n    this._driver.on(event, function() {\n      self.headers    = self._driver.headers;\n      self.statusCode = self._driver.statusCode;\n    });\n  }, this);\n\n  var proxy      = options.proxy || {},\n      endpoint   = url.parse(proxy.origin || this.url),\n      port       = endpoint.port || DEFAULT_PORTS[endpoint.protocol],\n      secure     = SECURE_PROTOCOLS.indexOf(endpoint.protocol) >= 0,\n      onConnect  = function() { self._onConnect() },\n      netOptions = options.net || {},\n      originTLS  = options.tls || {},\n      socketTLS  = proxy.origin ? (proxy.tls || {}) : originTLS,\n      self       = this;\n\n  netOptions.host = socketTLS.host = endpoint.hostname;\n  netOptions.port = socketTLS.port = port;\n\n  originTLS.ca = originTLS.ca || options.ca;\n  socketTLS.servername = socketTLS.servername || endpoint.hostname;\n\n  this._stream = secure\n               ? tls.connect(socketTLS, onConnect)\n               : net.connect(netOptions, onConnect);\n\n  if (proxy.origin) this._configureProxy(proxy, originTLS);\n\n  API.call(this, options);\n};\nutil.inherits(Client, API);\n\nClient.prototype._onConnect = function() {\n  var worker = this._proxy || this._driver;\n  worker.start();\n};\n\nClient.prototype._configureProxy = function(proxy, originTLS) {\n  var uri    = url.parse(this.url),\n      secure = SECURE_PROTOCOLS.indexOf(uri.protocol) >= 0,\n      self   = this,\n      name;\n\n  this._proxy = this._driver.proxy(proxy.origin);\n\n  if (proxy.headers) {\n    for (name in proxy.headers) this._proxy.setHeader(name, proxy.headers[name]);\n  }\n\n  this._proxy.pipe(this._stream, { end: false });\n  this._stream.pipe(this._proxy);\n\n  this._proxy.on('connect', function() {\n    if (secure) {\n      var options = { socket: self._stream, servername: uri.hostname };\n      for (name in originTLS) options[name] = originTLS[name];\n      self._stream = tls.connect(options);\n      self._configureStream();\n    }\n    self._driver.io.pipe(self._stream);\n    self._stream.pipe(self._driver.io);\n    self._driver.start();\n  });\n\n  this._proxy.on('error', function(error) {\n    self._driver.emit('error', error);\n  });\n};\n\nmodule.exports = Client;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}